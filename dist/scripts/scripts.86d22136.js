"use strict";angular.module("busFeedApp",["busFeedApp.filters","ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","uiGmapgoogle-maps","angularMoment"]).config(["$routeProvider",function(a){a.when("/:origin?/:destination/",{templateUrl:"views/main.html"}).when("/",{templateUrl:"views/main.html"})}]).config(["uiGmapGoogleMapApiProvider",function(a){a.configure({key:"AIzaSyCcF6B47_VLar_L3YSHO3vFVlVxJA3HLP8",v:"3.17",libraries:"weather,geometry,visualization"})}]).constant("angularMomentConfig",{preprocess:"unix",timezone:"Europe/London"});var sizeMultiplier="2",iconClassName={TRANSIT:"fa fa-bus fa-"+sizeMultiplier+"x",WALKING:"fa fa-male fa-"+sizeMultiplier+"x"},iconSeperator='<i class="fa fa-angle-right fa-'+sizeMultiplier+'x"></i>';angular.module("busFeedApp.filters",[]).filter("iconise_steps",function(){return function(a){var b=a.map(function(a){var b="";return"TRANSIT"===a.travel_mode&&(b=a.transit.line.short_name),'<i class="'+iconClassName[a.travel_mode]+'">&nbsp;'+b+"</i>"});return b.join(iconSeperator)}}),angular.module("busFeedApp").controller("MainCtrl",["$scope","$rootScope","$routeParams","$timeout","uiGmapGoogleMapApi",function(a,b,c,d,e){function f(b){var c=new b.DirectionsService;if("origin"in i||!navigator.geolocation)a.query=i,c.route(i,function(b,c){var d=new Hashes.MD5;console.log(c);for(var e=0;e<b.routes.length;e++)b.routes[e].md5=d.hex(angular.toJson(b.routes[e]));a.routes=b.routes});else{console.log("geolocation OK");var d=new b.Geocoder;navigator.geolocation.getCurrentPosition(function(e){var f=new b.LatLng(e.coords.latitude,e.coords.longitude);d.geocode({latLng:f},function(b,d){console.log("Reverse Geocoder",d),i.origin=b[0].formatted_address,a.query=i,c.route(i,function(b,c){var d=new Hashes.MD5;console.log(c);for(var e=0;e<b.routes.length;e++)b.routes[e].md5=d.hex(angular.toJson(b.routes[e]));a.routes=b.routes})})})}}function g(a){f(a),d(function(){g(a)},h)}a.routes=[];var h=3e4,i={destination:"Forrest Place, Perth",travelMode:"TRANSIT",provideRouteAlternatives:!0};angular.extend(i,c),e.then(function(a){g(a)})}]);var app=angular.module("busFeedApp");app.controller("TimeCtrl",["$scope","$rootScope","$timeout",function(a,b,c){b.clock="Time...",a.tickInterval=1e3;var d=function(){b.clock=Date.now(),c(d,a.tickInterval)};c(d,a.tickInterval)}]);